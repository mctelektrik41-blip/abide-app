<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ABIDE</title>
  <style>
    body { background-color: #111; color: #eee; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 0; display: flex; justify-content: center; min-height: 100vh; }
    .container { width: 100%; max-width: 400px; background: #111; padding: 20px; box-sizing: border-box; padding-bottom: 80px; }
    @keyframes pulse { 0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7); } 70% { transform: scale(1.1); box-shadow: 0 0 0 10px rgba(255, 0, 0, 0); } 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 0, 0, 0); } }
    .recording { animation: pulse 1.5s infinite; background: #c00 !important; border: 1px solid #f00 !important; }
  </style>
</head>
<body>
<div style="max-width:680px; margin:0 auto; padding:28px;">
  <h1 style="margin:0 0 10px 0;">ABIDE</h1>
  <p style="margin:0 0 22px 0; opacity:0.85;" id="subtitle">Gizli. YargÄ±sÄ±z. Sakin.</p>

  <div style="padding:16px; border:1px solid #333; border-radius:12px; margin-bottom:18px;">
    <div style="margin-bottom:8px; opacity:0.9;" id="setupTitle">BaÅŸlangÄ±Ã§</div>
    <div style="display:flex; gap:12px; flex-wrap:wrap; margin-bottom:10px; align-items:center;">
      <label id="langLabel">Dil:</label>
      <select id="lang" onchange="applyLang()" style="padding:8px 10px; border-radius:10px; border:1px solid #444; background:#0b0b0b; color:#fff;">
        <option value="tr" selected>TÃ¼rkÃ§e</option>
        <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
        <option value="en">English</option>
      </select>
      <label id="relLabel">Din:</label>
      <select id="religion" onchange="applyReligion()" style="padding:8px 10px; border-radius:10px; border:1px solid #444; background:#0b0b0b; color:#fff;">
        <option value="islam">Ä°slam</option>
        <option value="christianity">HristiyanlÄ±k</option>
        <option value="judaism">Yahudilik</option>
        <option value="buddhism">Budizm</option>
        <option value="spiritual">SpiritÃ¼el / Deist</option>
      </select>
    </div>
    <div style="display:flex; gap:12px; flex-wrap:wrap; margin-bottom:10px; align-items:center;" id="denomContainer">
      <label id="denomLabel">Mezhep/Yol:</label>
      <select id="denom" onchange="applyDenom()" style="flex:1; min-width:150px; padding:8px 10px; border-radius:10px; border:1px solid #444; background:#0b0b0b; color:#fff;"></select>
    </div>
    <div style="margin-bottom:12px;">
      <span id="genderLabel">Cinsiyet:</span>
      <select id="gender" onchange="applyGender()" style="padding:8px 10px; border-radius:10px; border:1px solid #444; background:#0b0b0b; color:#fff;">
        <option value="male" selected>Erkek</option>
        <option value="female">KadÄ±n</option>
      </select>
    </div>
    <!-- PREMIUM ALANI -->
    <div style="border-top:1px solid #444; margin-top:12px; padding-top:12px; text-align:center;">
      <button onclick="buyPremium()" id="btnPremium" style="background:linear-gradient(45deg, #FFD700, #FFA500); color:#000; border:none; padding:10px 20px; border-radius:20px; font-weight:bold; cursor:pointer; width:100%;">ğŸ‘‘ ReklamlarÄ± KaldÄ±r (30 TL)</button>
      <div id="premiumStatus" style="font-size:12px; color:#4CAF50; display:none; margin-top:5px;">âœ“ Premium Ãœye</div>
    </div>
  </div>

  <div style="padding:16px; border:1px solid #333; border-radius:12px; margin-bottom:18px;">
    <div style="margin-bottom:8px; opacity:0.9;" id="feelTitle">NasÄ±l hissediyorsun?</div>
    <div style="display:flex; flex-wrap:wrap; gap:10px;">
      <button onclick="triggerAI('tired')" style="padding:10px 14px; border-radius:10px; border:1px solid #444; background:#111; color:#fff; cursor:pointer;" id="btnTired">Yorgun</button>
      <button onclick="triggerAI('fear')" style="padding:10px 14px; border-radius:10px; border:1px solid #444; background:#111; color:#fff; cursor:pointer;" id="btnFear">KorkmuÅŸ</button>
      <button onclick="triggerAI('lonely')" style="padding:10px 14px; border-radius:10px; border:1px solid #444; background:#111; color:#fff; cursor:pointer;" id="btnAlone">YalnÄ±z</button>
      <button onclick="triggerAI('guilt')" style="padding:10px 14px; border-radius:10px; border:1px solid #444; background:#111; color:#fff; cursor:pointer;" id="btnGuilt">SuÃ§luluk</button>
    </div>
  </div>

  <div style="padding:16px; border:1px solid #333; border-radius:12px; margin-bottom:18px;">
    <div style="margin-bottom:8px; opacity:0.9;" id="replyTitle">ABIDE yanÄ±tÄ±</div>
    <div id="responseBox" style="padding:12px; border-radius:10px; border:1px solid #444; background:#0b0b0b; min-height:48px; opacity:0.95;">YanÄ±t bekliyor...</div>
    <div id="adWall" style="display:none; flex-direction:column; align-items:center; justify-content:center; margin-top:10px; padding:15px; background:#220; border:1px solid #dd0; border-radius:10px;">
      <div style="font-size:14px; color:#fff; margin-bottom:10px;">ğŸ”’ GÃ¼nlÃ¼k Limit Doldu</div>
      <button id="btnWatchAd" onclick="watchAd()" style="background:#f44336; color:white; padding:10px 20px; border:none; border-radius:20px; font-weight:bold; cursor:pointer;">ğŸ“º ReklamÄ± Ä°zle (+3 Hak)</button>
    </div>
  </div>

  <div style="padding:16px; border:1px solid #333; border-radius:12px; margin-bottom:18px;">
    <div style="margin-bottom:8px; opacity:0.9;" id="writeTitle">Ä°stersen yaz</div>
    <div style="position:relative; display:flex; gap:8px; align-items:flex-end;">
      <textarea id="note" rows="2" placeholder="Buraya yazabilirsin..." style="flex:1; width:100%; padding:12px; border-radius:12px; border:1px solid #444; background:#1a1a1a; color:#fff; font-family:inherit; resize:none;"></textarea>
      <button id="btnMic" onclick="toggleRecord()" style="width:44px; height:44px; border-radius:50%; border:1px solid #444; background:#222; color:#fff; cursor:pointer; font-size:20px; display:flex; align-items:center; justify-content:center;">ğŸ¤</button>
    </div>
    <div style="display:flex; justify-content:space-between; margin-top:10px;">
      <button onclick="submitText()" style="padding:10px 24px; border-radius:20px; border:none; background:#eee; color:#000; font-weight:bold; cursor:pointer;" id="btnSend">GÃ¶nder</button>
      <button onclick="clearNote()" style="padding:10px 16px; border-radius:20px; border:1px solid #555; background:transparent; color:#aaa; cursor:pointer;" id="btnClear">Sil</button>
    </div>
  </div>
  <p style="margin-top:18px; font-size:12px; opacity:0.65;" id="disclaimer">ABIDE bir dinÃ® kurum deÄŸildir.</p>
</div>

<script>
  const EMBEDDED_KEY = "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";
  var state = { lang: "tr", religion: "islam", denom: "sunni", gender: "male", premium: false, dailyCount: 0, lastVisit: new Date().toDateString() };
  var chatHistory = [];
  const RELIGIONS = { islam: { label: { tr: "Ä°slam", ru: "Ğ˜ÑĞ»Ğ°Ğ¼", en: "Islam" }, denoms: { sunni: { tr: "SÃ¼nni", ru: "Ğ¡ÑƒĞ½Ğ½Ğ¸Ğ·Ğ¼", en: "Sunni" }, shia: { tr: "Åii", ru: "Ğ¨Ğ¸Ğ¸Ğ·Ğ¼", en: "Shia" }, sufi: { tr: "Tasavvuf", ru: "Ğ¡ÑƒÑ„Ğ¸Ğ·Ğ¼", en: "Sufi" }, general: { tr: "Fark etmez", ru: "Ğ‘ĞµĞ· Ğ¼Ğ°Ğ·Ñ…Ğ°Ğ±Ğ°", en: "No Denom" } } }, christianity: { label: { tr: "HristiyanlÄ±k", ru: "Ğ¥Ñ€Ğ¸ÑÑ‚Ğ¸Ğ°Ğ½ÑÑ‚Ğ²Ğ¾", en: "Christianity" }, denoms: { orthodox: { tr: "Ortodoks", ru: "ĞŸÑ€Ğ°Ğ²Ğ¾ÑĞ»Ğ°Ğ²Ğ¸Ğµ", en: "Orthodox" }, catholic: { tr: "Katolik", ru: "ĞšĞ°Ñ‚Ğ¾Ğ»Ğ¸Ñ†Ğ¸Ğ·Ğ¼", en: "Catholic" }, protestant: { tr: "Protestan", ru: "ĞŸÑ€Ğ¾Ñ‚ĞµÑÑ‚Ğ°Ğ½Ñ‚Ğ¸Ğ·Ğ¼", en: "Protestant" } } } };
  var I18N = { tr: { subtitle: "Gizli. YargÄ±sÄ±z. Sakin.", setupTitle: "BaÅŸlangÄ±Ã§", langLabel: "Dil:", relLabel: "Din:", denomLabel: "Mezhep/Yol:", genderLabel: "Cinsiyet:", feelTitle: "NasÄ±l hissediyorsun?", btnTired: "Yorgun", btnFear: "KorkmuÅŸ", btnAlone: "YalnÄ±z", btnGuilt: "SuÃ§luluk", replyTitle: "ABIDE yanÄ±tÄ±", writeTitle: "Ä°stersen yaz", placeholder: "Buraya yazabilirsin...", btnSend: "GÃ¶nder", btnClear: "Sil", disclaimer: "ABIDE bir dinÃ® kurum deÄŸildir.", msgCleared: "Metin silindi.", msgNoText: "Bir ÅŸey yazmadÄ±n." } };

  function applyLang() { state.lang = document.getElementById('lang').value; renderI18n(); updateReligionsUI(); }
  function updateReligionsUI() { var rData = RELIGIONS[state.religion]; var dSelect = document.getElementById("denom"); dSelect.innerHTML = ""; if (rData && rData.denoms) { document.getElementById("denomContainer").style.display = "flex"; for (var key in rData.denoms) { var opt = document.createElement("option"); opt.value = key; opt.textContent = rData.denoms[key][state.lang]; dSelect.appendChild(opt); } } else { document.getElementById("denomContainer").style.display = "none"; } }
  function applyReligion() { state.religion = document.getElementById("religion").value; updateReligionsUI(); }
  function applyDenom() { state.denom = document.getElementById('denom').value; }
  function applyGender() { state.gender = document.getElementById('gender').value; }
  function renderI18n() { var t = I18N[state.lang]; document.getElementById('subtitle').textContent = t.subtitle; document.getElementById('setupTitle').textContent = t.setupTitle; document.getElementById('langLabel').textContent = t.langLabel; document.getElementById('relLabel').textContent = t.relLabel; document.getElementById('denomLabel').textContent = t.denomLabel; document.getElementById('genderLabel').textContent = t.genderLabel; document.getElementById('feelTitle').textContent = t.feelTitle; document.getElementById('btnTired').textContent = t.btnTired; document.getElementById('btnFear').textContent = t.btnFear; document.getElementById('btnAlone').textContent = t.btnAlone; document.getElementById('btnGuilt').textContent = t.btnGuilt; document.getElementById('replyTitle').textContent = t.replyTitle; document.getElementById('writeTitle').textContent = t.writeTitle; document.getElementById('btnSend').textContent = t.btnSend; document.getElementById('btnClear').textContent = t.btnClear; document.getElementById('disclaimer').textContent = t.disclaimer; document.getElementById('note').placeholder = t.placeholder; }
  function setResponse(msg) { document.getElementById('responseBox').textContent = msg; }
  function clearNote() { document.getElementById('note').value = ''; setResponse(I18N[state.lang].msgCleared); }

  async function triggerAI(tag) {
    var userText = tag === 'tired' ? 'Ã‡ok yorgunum.' : 'Kendimi huzursuz hissediyorum.';
    setResponse("Abide dÃ¼ÅŸÃ¼nÃ¼yor...");
    var resp = await callHuggingFaceAI(userText);
    if (resp) { setResponse(resp); speakResponse(resp); }
  }

  function checkDailyLimit() { if (state.premium) return true; if (state.dailyCount >= 3) { document.getElementById("adWall").style.display = "flex"; return false; } return true; }
  function incrementUsage() { state.dailyCount++; }
  function watchAd() { setTimeout(() => { alert("Hak verildi!"); state.dailyCount = 0; document.getElementById("adWall").style.display = "none"; }, 2000); }

  async function callHuggingFaceAI(userText) {
    if (!checkDailyLimit()) return null;
    var apiKey = EMBEDDED_KEY;
    var apiUrl = "https://router.huggingface.co/v1/chat/completions";
    var systemInstruction = `Sen Abide'sin. Bilge bir rehbersin.`;
    try {
      var response = await fetch(apiUrl, {
        method: "POST",
        headers: { "Authorization": "Bearer " + apiKey, "Content-Type": "application/json" },
        body: JSON.stringify({ model: "Qwen/Qwen2.5-7B-Instruct", messages: [{role:"system", content:systemInstruction}, {role:"user", content:userText}], max_tokens: 500 })
      });
      var data = await response.json();
      if (data.choices) { incrementUsage(); return data.choices[0].message.content; }
      return "Bir hata oluÅŸtu.";
    } catch (e) { return "BaÄŸlantÄ± sorunu."; }
  }

  function speakResponse(text) { if (!window.speechSynthesis) return; window.speechSynthesis.cancel(); var u = new SpeechSynthesisUtterance(text); u.lang = state.lang === 'tr' ? 'tr-TR' : 'en-US'; window.speechSynthesis.speak(u); }

  async function submitText() { var text = document.getElementById('note').value.trim(); if (!text) return; setResponse("Abide dÃ¼ÅŸÃ¼nÃ¼yor..."); var resp = await callHuggingFaceAI(text); if (resp) { setResponse(resp); speakResponse(resp); } }

  renderI18n();
  updateReligionsUI();
</script>
</body>
</html>
